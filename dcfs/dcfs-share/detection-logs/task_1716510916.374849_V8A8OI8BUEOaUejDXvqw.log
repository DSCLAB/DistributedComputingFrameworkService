2024-05-24 00:35:16,375 - [INFO]
V8A8OI8BUEOaUejDXvqw
[/dcfs-share/dcfs-run/detection.py <module> 50]

2024-05-24 00:35:16,375 - [INFO]

[/dcfs-share/dcfs-run/detection.py <module> 51]

2024-05-24 00:35:16,375 - [INFO]
Start doing detection task.
[/dcfs-share/dcfs-run/detection.py <module> 54]

2024-05-24 00:35:16,375 - [INFO]
Connect to elasticsearch.
[/dcfs-share/dcfs-run/detection.py <module> 55]

2024-05-24 00:35:16,375 - [INFO]
Connect finished.
[/dcfs-share/dcfs-run/detection.py <module> 66]

2024-05-24 00:35:16,375 - [INFO]
Start gathering information about detection task.
[/dcfs-share/dcfs-run/detection.py get_detection_task 79]

2024-05-24 00:35:16,378 - [INFO]
{'TaskInfo': {'TaskName': '0415_mssql_int+str', 'Ip': '192.168.103.174', 'Port': '3306', 'DbName': 'TestDB', 'DbType': 'mysql', 'UserName': 'yuyu', 'Password': 'tp6ej04m6', 'TableName': 'Score', 'IntColCheckList': ['Chinese', 'Science', 'Math'], 'StrColCheckList': ['item'], 'ExpectCount': 3, 'Intervals': 1, 'IntPkCol': None, 'TimestampCol': None, 'SuccessCount': 1, 'FailCount': 2, 'ExecutionCount': 3, 'Enable': True, 'StartTime': '2024-05-02T07:37:11.585077', 'NextTime': '2024-05-02T11:37:11.585077', 'TaskID': 'V8A8OI8BUEOaUejDXvqw', 'TaskSetUpTime': '2024-05-02T07:37:11.601905', 'db_url': 'mysql+pymysql://yuyu:tp6ej04m6@192.168.103.174:3306/TestDB'}, 'InitialStat': {'item': {'CategorySet': ['Test 1'], 'DataType': 'category'}, 'Science': {'Mean': 84, 'Min': 70, 'Max': 92, 'Var': 6, 'DataType': 'num', 'Percentiles': [70.0, 78.1, 79.8, 81.4, 83.2, 84.5, 85.8, 87.3, 88.4, 90.2, 92.0]}, 'Chinese': {'Mean': 82, 'Min': 65, 'Max': 95, 'Var': 9, 'DataType': 'num', 'Percentiles': [65.0, 72.2, 75.4, 77.4, 81.6, 84.5, 86.2, 88.0, 88.4, 90.5, 95.0]}, 'Math': {'Mean': 85, 'Min': 75, 'Max': 94, 'Var': 7, 'DataType': 'num', 'Percentiles': [75.0, 76.8, 77.8, 82.9, 85.6, 86.5, 87.8, 89.6, 91.2, 92.2, 94.0]}}}
[/dcfs-share/dcfs-run/detection.py get_detection_task 95]

2024-05-24 00:35:16,378 - [INFO]
Check whether to calculate statistics or do detection.
[/dcfs-share/dcfs-run/detection.py calculate_statistics_or_detection 99]

2024-05-24 00:35:16,378 - [INFO]
Calculate statistics.
[/dcfs-share/dcfs-run/detection.py calculate_statistics_or_detection 101]

2024-05-24 00:35:16,378 - [INFO]
Check detection size.
[/dcfs-share/dcfs-run/detection.py check_data_size 106]

2024-05-24 00:35:16,386 - [INFO]
SELECT count(*) AS row_count FROM Score
[/dcfs-share/dcfs-run/detection.py check_data_size 140]

2024-05-24 00:35:16,392 - [INFO]
   row_count
0         80
[/dcfs-share/dcfs-run/detection.py check_data_size 143]

2024-05-24 00:35:16,395 - [INFO]
Task row count: 80
[/dcfs-share/dcfs-run/detection.py check_data_size 147]

2024-05-24 00:35:16,395 - [INFO]
Start getting sample data
[/dcfs-share/dcfs-run/detection.py get_sample_data 159]

2024-05-24 00:35:16,400 - [INFO]
['Chinese', 'Science', 'StudentId', 'Math', 'item']
[/dcfs-share/dcfs-run/detection.py get_sample_data 222]

2024-05-24 00:35:16,401 - [INFO]
   Chinese  Science  StudentId  Math    item
0       78       85          1    92  Test 1
1       88       90          2    87  Test 1
2       65       70          3    75  Test 1
[/dcfs-share/dcfs-run/detection.py get_sample_data 223]

2024-05-24 00:35:16,406 - [INFO]
Start executing detection task.
[/dcfs-share/dcfs-run/detection.py detect_data_quality 327]

2024-05-24 00:35:16,407 - [INFO]
{'TaskID': 'V8A8OI8BUEOaUejDXvqw', 'TaskName': '0415_mssql_int+str', 'TaskStatus': True, 'Timestamp': '2024-05-24T00:35:16.407678', 'ValidationResult': False, 'Result': {'SampleNum': 80, 'Detail': {'Chinese': {'DataType': 'num', 'Mean': 80, 'Var': 10, 'Min': 56, 'Max': 95, 'Percentiles': [56.0, 65.0, 70.0, 75.0, 77.0, 80.5, 84.0, 87.3, 89.0, 91.1, 95.0], 'ValueOutOf3var': [], 'ValueOutOf5var': [], 'IsPass': True}, 'Science': {'DataType': 'num', 'Mean': 84, 'Var': 9, 'Min': 67, 'Max': 100, 'Percentiles': [67.0, 70.0, 75.0, 79.0, 82.0, 85.0, 87.4, 90.0, 92.0, 95.0, 100.0], 'ValueOutOf3var': [], 'ValueOutOf5var': [], 'IsPass': True}, 'Math': {'DataType': 'num', 'Mean': 84, 'Var': 9, 'Min': 65, 'Max': 99, 'Percentiles': [65.0, 71.0, 75.0, 77.7, 80.6, 85.0, 87.0, 89.3, 92.2, 95.0, 99.0], 'ValueOutOf3var': [], 'ValueOutOf5var': [], 'IsPass': True}, 'item': {'DataType': 'category', 'ValueOutOfSet': ['Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6'], 'IsPass': False}}}, 'ExecutionType': 'Auto'}
[/dcfs-share/dcfs-run/detection.py detect_data_quality 477]

2024-05-24 00:35:16,407 - [INFO]
Start recording detection result.
[/dcfs-share/dcfs-run/detection.py record_detection 481]

2024-05-24 00:35:16,407 - [INFO]
{'TaskID': 'V8A8OI8BUEOaUejDXvqw', 'TaskName': '0415_mssql_int+str', 'TaskStatus': True, 'Timestamp': '2024-05-24T00:35:16.407824', 'ValidationResult': False, 'Result': {'SampleNum': 80, 'Detail': {'Chinese': {'DataType': 'num', 'Mean': 80, 'Var': 10, 'Min': 56, 'Max': 95, 'Percentiles': [56.0, 65.0, 70.0, 75.0, 77.0, 80.5, 84.0, 87.3, 89.0, 91.1, 95.0], 'ValueOutOf3var': [], 'ValueOutOf5var': [], 'IsPass': True}, 'Science': {'DataType': 'num', 'Mean': 84, 'Var': 9, 'Min': 67, 'Max': 100, 'Percentiles': [67.0, 70.0, 75.0, 79.0, 82.0, 85.0, 87.4, 90.0, 92.0, 95.0, 100.0], 'ValueOutOf3var': [], 'ValueOutOf5var': [], 'IsPass': True}, 'Math': {'DataType': 'num', 'Mean': 84, 'Var': 9, 'Min': 65, 'Max': 99, 'Percentiles': [65.0, 71.0, 75.0, 77.7, 80.6, 85.0, 87.0, 89.3, 92.2, 95.0, 99.0], 'ValueOutOf3var': [], 'ValueOutOf5var': [], 'IsPass': True}, 'item': {'DataType': 'category', 'ValueOutOfSet': ['Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 2', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 3', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 4', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 5', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6', 'Test 6'], 'IsPass': False}}}, 'ExecutionType': 'Auto'}
[/dcfs-share/dcfs-run/detection.py record_detection 485]

2024-05-24 00:35:16,407 - [INFO]
{'doc': {'TaskInfo': {'ExecutionCount': 4, 'FailCount': 3, 'Enable': False}}}
[/dcfs-share/dcfs-run/detection.py record_detection 512]

2024-05-24 00:35:16,413 - [INFO]
{'_index': 'data_detection_result', '_id': 'irgFqI8BGsMMX9qu_-A4', '_version': 1, 'result': 'created', '_shards': {'total': 2, 'successful': 1, 'failed': 0}, '_seq_no': 166, '_primary_term': 8}
[/dcfs-share/dcfs-run/detection.py record_detection 515]

2024-05-24 00:35:16,413 - [INFO]
{'_index': 'data_detection_task', '_id': 'V8A8OI8BUEOaUejDXvqw', '_version': 11, 'result': 'updated', '_shards': {'total': 2, 'successful': 1, 'failed': 0}, '_seq_no': 790, '_primary_term': 8}
[/dcfs-share/dcfs-run/detection.py record_detection 516]

2024-05-24 00:35:16,413 - [INFO]
Detection task end.
[/dcfs-share/dcfs-run/detection.py <module> 608]

